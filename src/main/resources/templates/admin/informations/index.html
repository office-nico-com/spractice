	<!doctype html>
<html lang="ja">

<head th:replace="admin/commons::head(title=~{::title}, links=~{::link}, styles=~{::style})">
<title>共有情報管理｜Secure Practice Admin</title>

</head>

<body th:with="menuCode=101009,length=${T(com.office_nico.spractice.constants.Length)}">

<!-- ナビゲーション／上部ナビゲーション -->
<header th:replace="admin/commons::header(${menuCode})"></header>

<!-- メインコンテナ -->
<div id="mainContainer" class="main-container">

<!-- 左側ナビゲーション -->
<div class="left-nav" th:replace="admin/commons::leftNavigation(${menuCode})"></div>

<!-- 右側コンテンツ -->
<div class="content-outer"><div class="content-main"><div class="container-fluid">
<!--/* **************************** Start processing for each screen **************************** */-->

<nav aria-label="breadcrumb">
<ol class="breadcrumb">
	<li class="breadcrumb-item active" aria-current="page">共有情報管理</li>
</ol>
</nav>

<div class="card mb-3">
	<div class="card-header function-title-bar">共有情報リスト<button onclick="create();" class="btn btn-outline-info btn-sm btn-round float-right">新規登録</button></div>
	<div class="card-body">
	<table id="table1" class="table table-striped table-bordered">
	<thead>
		<tr>
			<th scope="col">ID</th>
			<th scope="col" width="15%">登録日時</th>
			<th scope="col" width="50%">メッセージ</th>
			<th scope="col" width="15%">投稿者</th>
			<th scope="col" width="25%">ダッシュボードへの掲載</th>
		</tr>
	</thead>
	</table>
</div>
</div>

<!--/* **************************** End processing for each screen **************************** */-->
</div></div></div><!-- /.container-fluid --><!-- /.content-main --><!-- /.content-outer -->

<!-- フッター -->
<footer th:replace="admin/commons::footer"></footer>
</div><!--  /.main-container -->

</body>

<th:block th:replace="admin/commons::scripts(scripts=~{::script})">
<script type="text/javascript" th:inline="javascript">

$(function(){
	var render1=function(data, type, row){
		return '<a href="' + [# th:text="@{/t06o1ny8/informations/show/}" /] + row.id + '">' + (data == null ? '－' : hbr(data)) + "</a>";
	}

	var render2=function(data, type, row){
		var str = "";
		var str = "";
		if(data == true){
			str = "掲載する";
			
			if((row.showStartedOn != null && row.showStartedOn != '') || (row.showEndedOn != null && row.showEndedOn != '')){
				str += "<br/>";
				if(row.showStartedOn != null && row.showStartedOn != ''){
					var _data = row.showStartedOn.replace("/0", "/");
					_data = _data.replace("/0", "/");
					_data = _data.replace(" 0", " ");
					str += _data;
				}
				str += " ～ ";
				if(row.showEndedOn != null && row.showEndedOn != ''){
					var _data = row.showEndedOn.replace("/0", "/");
					_data = _data.replace("/0", "/");
					_data = _data.replace(" 0", " ");
					str += _data;
				}
			}
		}
		else{
			str = "掲載しない";
		}
		return '<a href="' + [# th:text="@{/t06o1ny8/informations/show/}" /] + row.id + '">' + str + "</a>";
	}

	var render3=function(data, type, row){
		// postgersの日付形式を再整形
		data = data.replace("/0", "/");
		data = data.replace("/0", "/");
		data = data.replace(" 0", " ");
		return '<a href="' + [# th:text="@{/t06o1ny8/informations/show/}" /] + row.id + '">' + (data == null ? '－' : hbr(data)) + "</a>";
	}

	var render4=function(data, type, row){
		var str = "";
		str += row.familyName;
		str += " ";
		str += row.givenName;
		return '<a href="' + [# th:text="@{/t06o1ny8/informations/show/}" /] + row.id + '">' + (str == null ? '－' : hbr(str)) + "</a>";
	}

	
	// 初期化
	if($.cookie("datatableclear") == 'true'){
		$("#table1").DataTable().state.clear().destroy();
		$.cookie("datatableclear", 'false', { path:'/' });
	}

	// datatableの設定を変更
	var $table = $("#table1").DataTable({
		searching: false,
		serverSide: true,
		ordering: false,
		stateSave: true,
		"ajax": {
			"url": [# th:text="@{/t06o1ny8/informations/list}" /],
			"type": "GET"
		},
		"order": [ [1, 'desc'] ],
		language: {
			"url": "//cdn.datatables.net/plug-ins/1.10.25/i18n/Japanese.json",
		},

		// If you want to use a 100% width table, set scrollX to false.
		// If you want to use a fixed table, set scrollX to true.
		//		scrollX: true,
		columns: [
			{targets: 0, data: "id", visible: false, /* width:"0%", */ orderable:false, render:render1},
			{targets: 1, data: "postedAt", visible: true, /* width:"0%", */ orderable:false, render:render3},
			{targets: 2, data: "message", visible: true, /* width:"0%", */ orderable:false, render:render1},
			{targets: 3, data: "familyName", visible: true, /* width:"0%", */ orderable:false, render:render4},
			{targets: 4, data: "isShowDashboard", visible: true, /* width:"0%", */ orderable:false, render:render2},
		],
		"drawCallback":function(settings){
			$('table.table tr td a, table.table tr th a').hover(
					function(){
						$(this).parent().parent().find("a").addClass('hover');
					},
					function(){
						$(this).parent().parent().find("a").removeClass('hover');
					}
			);
		}
	});
	// If you want to use a 100% width table.
	$('#table1').css("width", "100%");

});

const create = () => {
	location.href = [# th:text="@{/t06o1ny8/informations/new}" /];
};

</script>
</th:block>
</html>

